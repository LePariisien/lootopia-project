<div *ngIf="profile && player" class="flex flex-col lg:flex-row min-h-screen p-4 md:p-8 text-gray-800">
  <main class="flex flex-1 flex-col lg:flex-row gap-6">
    <aside class="w-full lg:w-64 bg-white shadow-lg rounded-lg p-4 space-y-6 text-center lg:text-left">
      <div class="h-24 w-24 rounded-full bg-gray-200 mx-auto overflow-hidden">
        <img *ngIf="player.avatarUrl" [src]="profile.avatarUrl" alt="Avatar"
          class="h-full w-full object-cover rounded-full" />
      </div>
      <div class="font-semibold text-lg">{{ profile.username }}</div>
      <div class="text-sm text-gray-500">{{ player.nickname }} ({{ player.country }})</div>
      <div class="text-xs italic text-gray-400 mt-2">{{ player.bio }}</div>

      <nav class="flex flex-wrap justify-center lg:flex-col lg:space-y-2 text-gray-700 mt-4 gap-4 lg:gap-2">
        <a href="#" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-100 transition"><span>👥</span> <span
            class="hidden sm:inline lg:inline">Mes amis</span></a>
        <a href="#" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-100 transition"><span>🗺️</span>
          <span class="hidden sm:inline lg:inline">Mes chasses</span></a>
        <a href="#" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-100 transition"><span>📦</span> <span
            class="hidden sm:inline lg:inline">Mes artefacts</span></a>
        <a href="#" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-100 transition"><span>📊</span> <span
            class="hidden sm:inline lg:inline">Mes statistiques</span></a>
        <a href="#" class="flex items-center gap-2 px-2 py-1 rounded hover:bg-gray-100 transition"><span>👑</span> <span
            class="hidden sm:inline lg:inline">Mes couronnes</span></a>
      </nav>
    </aside>

    <section class="flex-1 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6">
      <div class="col-span-full lg:col-span-2 bg-white rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl font-semibold mb-4">Mes dernières chasses</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
          <ng-container *ngFor="let slot of participationSlots; let i = index">
            <div *ngIf="participations[i]; else emptyParticipationSlot" class="flex flex-col">
              <div class="flex flex-col border rounded p-2">
                <div class="h-24 bg-gray-200 rounded flex items-center justify-center mb-2">
                  <img *ngIf="participations[i]?.image" [src]="participations[i]?.image"
                    alt="{{ participations[i]?.name }}" class="h-full w-full object-cover rounded" />
                  <span *ngIf="!participations[i]?.image" class="text-3xl text-gray-400">?</span>
                </div>
                <div class="flex justify-between items-center">
                  <div class="flex items-center gap-2">
                    <span class="bg-green-600 text-white rounded px-2 py-1 text-xs">{{ participations[i]?.status }}</span>
                    <div class="text-xs text-gray-500">Fin le {{ participations[i]?.endDate }}</div>
                  </div>
                  <button class="bg-transparent border border-green-500 text-green-500 flex justify-center items-center gap-1 px-2 py-1 rounded text-xs hover:bg-green-700 hover:text-white transition"
                    (click)="viewParticipationDetails(participations[i]?.id || '')">
                    Détails
                    <lucide-icon [img]="ChevronRight" class="size-4"></lucide-icon>
                  </button>
                </div>
                <div class="font-semibold line-clamp-1">{{ participations[i]?.name }}</div>
              </div>
            </div>
            <ng-template #emptyParticipationSlot>
              <div class="flex flex-col gap-2 border rounded p-2">
                <div class="h-24 bg-gray-200 rounded flex items-center justify-center text-3xl text-gray-400">?</div>
                <div class="block bg-gray-200 w-20 h-4 rounded"></div>
                <div class="block bg-gray-200 w-30 h-4 rounded"></div>
              </div>
            </ng-template>
          </ng-container>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl font-semibold mb-4">Mes artefacts</h2>
        <div class="grid grid-cols-3 gap-2 justify-items-center">
          <ng-container *ngFor="let slot of slots; let i = index">
            <div *ngIf="artefacts[i]; else emptySlot" class="flex flex-col items-center relative group">
              <div class="relative size-24 xl:size-28 rounded-full flex items-center justify-center border-4 mx-auto"
                [ngStyle]="{'border-color': artefacts[i]?.rarityColor}">
                <img [src]="artefacts[i]?.image || '/assets/images/placeholder.svg'" [alt]="artefacts[i]?.name"
                  class="size-20 xl:size-24 object-cover rounded-full" />
                <div class="absolute -top-1 -right-1 w-6 h-6 rounded-full flex items-center justify-center text-white text-xs"
                  [ngStyle]="{'background-color': artefacts[i]?.rarityColor}">
                  <lucide-icon [img]="getRarityIcon(artefacts[i]?.rarity || '')" class="size-4"></lucide-icon>
                </div>
              </div>
              <div class="absolute -bottom-3 w-max text-xs font-bold text-white px-2 py-1 rounded-md hidden group-hover:block"
                [ngStyle]="{'background-color': artefacts[i]?.rarityColor}">
                {{ artefacts[i]?.name }}
              </div>
            </div>
            <ng-template #emptySlot>
              <div
                class="size-24 xl:size-28 rounded-full border-4 border-gray-300 flex items-center justify-center text-3xl text-gray-400 bg-gray-100">
                ?</div>
            </ng-template>
          </ng-container>
        </div>
      </div>

      <div class="col-span-full lg:col-span-2 bg-white rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl font-semibold mb-4">Mes Statistiques</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 text-center">
          <div>
            <div class="text-2xl sm:text-3xl font-bold text-green-600">{{ profile.huntsCompleted }}</div>
            <div>Chasses terminées</div>
          </div>
          <div>
            <div class="text-2xl sm:text-3xl font-bold text-green-600">{{ profile.treasuresFound }}</div>
            <div>Trésors trouvés</div>
          </div>
          <div>
            <div class="text-2xl sm:text-3xl font-bold text-green-600">{{ profile.riddlesSolved }}</div>
            <div>Énigmes résolues</div>
          </div>
          <div>
            <div class="text-2xl sm:text-3xl font-bold text-green-600">{{ profile.badgesWon }}</div>
            <div>Badges gagnés</div>
          </div>
        </div>
        <div class="text-center mt-4 text-gray-500">
          Niveau actuel : <span class="text-green-700 font-bold">{{ player.score }}</span>
        </div>
      </div>

      <div class="bg-white rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl font-semibold mb-4 text-center">Mes couronnes</h2>
        <div class="text-4xl sm:text-5xl font-bold text-yellow-500 text-center">{{ crownCount }}</div>
        <div class="text-sm text-gray-500 text-center mb-4">Total disponible</div>
        <ul class="text-sm text-gray-600 space-y-1 mt-4">
          <li><span class="text-red-500">-20</span> — Item 1</li>
          <li><span class="text-red-500">-10</span> — Item 2</li>
          <li><span class="text-red-500">-50</span> — Item 3</li>
          <li><span class="text-red-500">-5</span> — Item 4</li>
        </ul>
      </div>

      <div class="bg-white rounded-lg shadow p-4 sm:p-6">
        <h2 class="text-xl font-semibold mb-4">Mes amis</h2>
        <div class="space-y-2">
          <div *ngFor="let i of [].constructor(5)" class="flex items-center gap-2">
            <div class="w-8 h-8 rounded-full bg-gray-300"></div>
            <div>Amis</div>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>

<div *ngIf="!profile || !player" class="text-center mt-20 text-gray-500">
  Chargement du profil...
</div>
